<div class="container-fluid mb-5">
  <div class="row">
    <div class="col-md-12 bg-light">
      <h1 class="text-center text-primary mt-3" [innerText]="currentExam?.examName"></h1>
    </div>
  </div>
  <div class="row mb-2">
    <nz-tabset class="col-xl-10 left-content" [(nzSelectedIndex)]="selectedIndex">
      <nz-tab nzTitle="Part 1">
        <div class="row">
          <div class="col-12">
            <p class="text-dark mt-3 fs-6 part-content">
              {{listPart[0]?.partContent}}
            </p>
          </div>
          <div class="col-5">
            <app-audio-part [audioSource]="listPart[0]?.partAudio"></app-audio-part>
          </div>
          <ng-container *ngFor="let item of listPart[0]?.questions; let part1Index = index;">
            <div class="row" id="questionContainer_0_{{item?.questionId}}">
              <div class="col-12">
                Câu  {{item?.questionNumber}}
              </div>
              <div class="col-12">
                <img
                  nz-image
                  width="400px"
                  height="400px"
                  class="nz-image"
                  [nzSrc]="item?.questionImage"
                  [alt]="currentExam?.examName"
                />
              </div>
              <div class="col-12">
                <nz-radio-group nzName="radiogroup"
                                [(ngModel)]="selectedAnswer[item?.questionId]"
                                (ngModelChange)="changeStateButton($event, item?.questionId)">
                  <label nz-radio nzValue="A">A</label>
                  <label nz-radio nzValue="B">B</label>
                  <label nz-radio nzValue="C">C</label>
                  <label nz-radio nzValue="D">D</label>
                </nz-radio-group>
              </div>
            </div>
          </ng-container>

          <div class="col-12 d-flex flex-row-reverse">
            <a class="btn btn-link" (click)="nextPart()">
              Next Part
              <i class="fa fa-arrow-right"></i>
            </a>
          </div>
        </div>
      </nz-tab>
      <nz-tab nzTitle="Part 2">
        <div class="row">
          <div class="col-12">
            <p class="text-dark mt-3 fs-6 part-content">
              {{listPart[1]?.partContent}}
            </p>
          </div>
          <div class="col-5">
            <app-audio-part [audioSource]="listPart[1]?.partAudio"></app-audio-part>
          </div>
          <ng-container *ngFor="let item of listPart[1]?.questions; let part2Index = index;">
            <div class="row" id="questionContainer_1_{{item?.questionId}}">
              <div class="col-12">
                Câu  {{item?.questionNumber}}
              </div>
              <div class="col-12">
                <nz-radio-group nzName="radiogroup"
                                [(ngModel)]="selectedAnswer[item?.questionId]"
                                (ngModelChange)="changeStateButton($event, item?.questionId)"
                >
                  <label nz-radio nzValue="A">A</label>
                  <label nz-radio nzValue="B">B</label>
                  <label nz-radio nzValue="C">C</label>
                  <label nz-radio nzValue="D">D</label>
                </nz-radio-group>
              </div>
            </div>
          </ng-container>
          <div class="col-12 d-flex justify-content-between">
            <a class="btn btn-link" (click)="previousPart()">
              <i class="fa fa-arrow-left"></i>
              Previous Part
            </a>
            <a class="btn btn-link" (click)="nextPart()">
              Next Part
              <i class="fa fa-arrow-right"></i>
            </a>
          </div>
        </div>
      </nz-tab>
      <nz-tab nzTitle="Part 3">
        <div class="row">
          <div class="col-12">
            <p class="text-dark mt-3 fs-6 part-content">
              {{listPart[2]?.partContent}}
            </p>
          </div>
          <div class="col-5">
            <app-audio-part [audioSource]="listPart[2]?.partAudio"></app-audio-part>
          </div>
          <ng-container *ngFor="let item of listPart[2]?.questions; let part3Index = index;">
            <div class="row" id="questionContainer_2_{{item?.questionId}}">
              <ng-container *ngIf="part3Index % 3 == 0">
                <span class="col-12 mt-2 fs-6">Question {{item?.questionNumber}} - {{Number(item?.questionNumber) + 2}}
                  refer to
                  following conversation: </span>
              </ng-container>
              <ng-container
                *ngIf="item?.questionNumber == 62 || item?.questionNumber == 65 || item?.questionNumber == 68">
                <div class="col-12">
                  <img
                    nz-image
                    width="400px"
                    height="400px"
                    class="nz-image"
                    [nzSrc]="item?.questionImage"
                    [alt]="currentExam?.examName"
                  />
                </div>
              </ng-container>
              <div class="col-12" translate="no">
                Câu  {{item?.questionNumber}}: {{item?.questionContent}}
              </div>
              <div class="col-12">
                <nz-radio-group nzName="radiogroup" translate="no"
                                [(ngModel)]="selectedAnswer[item?.questionId]"
                                (ngModelChange)="changeStateButton($event, item?.questionId)">
                  <label nz-radio nzValue="A">A: {{item?.answerA}}</label>
                  <label nz-radio nzValue="B">B: {{item?.answerB}}</label>
                  <label nz-radio nzValue="C">C: {{item?.answerC}}</label>
                  <label nz-radio nzValue="D">D: {{item?.answerD}}</label>
                </nz-radio-group>
              </div>
            </div>
          </ng-container>
          <div class="col-12 d-flex justify-content-between">
            <a class="btn btn-link" (click)="previousPart()">
              <i class="fa fa-arrow-left"></i>
              Previous Part
            </a>
            <a class="btn btn-link" (click)="nextPart()">
              Next Part
              <i class="fa fa-arrow-right"></i>
            </a>
          </div>
        </div>
      </nz-tab>
      <nz-tab nzTitle="Part 4">
        <div class="row">
          <div class="col-12">
            <p class="text-dark mt-3 fs-6 part-content">
              {{listPart[3]?.partContent}}
            </p>
          </div>
          <div class="col-5">
            <app-audio-part [audioSource]="listPart[3]?.partAudio"></app-audio-part>
          </div>
          <ng-container *ngFor="let item of listPart[3]?.questions; let part4Index = index;">
            <div class="row" id="questionContainer_3_{{item?.questionId}}">
              <ng-container *ngIf="part4Index % 3 == 0">
                <span class="col-12 mt-2 fs-6">Question {{item?.questionNumber}} - {{Number(item?.questionNumber) + 2}}
                  refer to
                  following conversation: </span>
              </ng-container>
              <ng-container
                *ngIf="item?.questionNumber == 95 || item?.questionNumber == 98">
                <div class="col-12">
                  <img
                    nz-image
                    width="400px"
                    height="400px"
                    class="nz-image"
                    [nzSrc]="item?.questionImage"
                    [alt]="currentExam?.examName"
                  />
                </div>
              </ng-container>
              <div class="col-12" translate="no">
                Câu  {{item?.questionNumber}}: {{item?.questionContent}}
              </div>
              <div class="col-12">
                <nz-radio-group nzName="radiogroup" translate="no"
                                [(ngModel)]="selectedAnswer[item?.questionId]"
                                (ngModelChange)="changeStateButton($event, item?.questionId)">
                  <label nz-radio nzValue="A">A: {{item?.answerA}}</label>
                  <label nz-radio nzValue="B">B: {{item?.answerB}}</label>
                  <label nz-radio nzValue="C">C: {{item?.answerC}}</label>
                  <label nz-radio nzValue="D">D: {{item?.answerD}}</label>
                </nz-radio-group>
              </div>
            </div>
          </ng-container>
          <div class="col-12 d-flex justify-content-between">
            <a class="btn btn-link" (click)="previousPart()">
              <i class="fa fa-arrow-left"></i>
              Previous Part
            </a>
            <a class="btn btn-link" (click)="nextPart()">
              Next Part
              <i class="fa fa-arrow-right"></i>
            </a>
          </div>
        </div>
      </nz-tab>
      <nz-tab nzTitle="Part 5">
        <div class="row">
          <div class="col-12">
            <p class="text-dark mt-3 fs-6 part-content">
              {{listPart[4]?.partContent}}
            </p>
          </div>
          <ng-container *ngFor="let item of listPart[4]?.questions; let part5Index = index;">
            <div class="row" id="questionContainer_4_{{item?.questionId}}">
              <div class="col-12" translate="no">
                Câu  {{item?.questionNumber}}: {{item?.questionContent}}
              </div>
              <div class="col-12">
                <nz-radio-group nzName="radiogroup" translate="no"
                                [(ngModel)]="selectedAnswer[item?.questionId]"
                                (ngModelChange)="changeStateButton($event, item?.questionId)">
                  <label nz-radio nzValue="A">A: {{item?.answerA}}</label>
                  <label nz-radio nzValue="B">B: {{item?.answerB}}</label>
                  <label nz-radio nzValue="C">C: {{item?.answerC}}</label>
                  <label nz-radio nzValue="D">D: {{item?.answerD}}</label>
                </nz-radio-group>
              </div>
            </div>
          </ng-container>
          <div class="col-12 d-flex justify-content-between">
            <a class="btn btn-link" (click)="previousPart()">
              <i class="fa fa-arrow-left"></i>
              Previous Part
            </a>
            <a class="btn btn-link" (click)="nextPart()">
              Next Part
              <i class="fa fa-arrow-right"></i>
            </a>
          </div>
        </div>
      </nz-tab>
      <nz-tab nzTitle="Part 6">
        <div class="row">
          <div class="col-12">
            <p class="text-dark mt-3 fs-6 part-content">
              {{listPart[5]?.partContent}}
            </p>
          </div>
          <ng-container *ngFor="let item of listPart[5]?.questions; let part6Index = index;">
            <div class="row">
              <ng-container *ngIf="part6Index % 4 == 0">
                <span class="col-12 mt-2 fs-6">Question {{item?.questionNumber}} - {{Number(item?.questionNumber) + 3}}
                  refer to
                  following conversation: </span>
                <div class="col-7 fs-6 paragraph" translate="no">
                  <pre>
                    {{item?.paragraph1}}
                  </pre>
                </div>
                <div class="col-5 px-2">
                  <div class="row">
                    <ng-container *ngFor="let i of counter(4); let counterIndex = index;">
                      <div class="col-12 mt-1" translate="no" id="questionContainer_5_{{listPart[5]?.questions[part6Index + counterIndex]?.questionId}}">
                        Câu  {{listPart[5]?.questions[part6Index + counterIndex]?.questionNumber}}:
                      </div>
                      <div class="col-12">
                        <nz-radio-group nzName="radiogroup" translate="no"
                                        [(ngModel)]="selectedAnswer[listPart[5]?.questions[part6Index + counterIndex]?.questionId]"
                                        (ngModelChange)="changeStateButton($event, listPart[5]?.questions[part6Index + counterIndex]?.questionId)">
                          <label nz-radio
                                 nzValue="A">A: {{listPart[5]?.questions[part6Index + counterIndex]?.answerA}}</label>
                          <label nz-radio
                                 nzValue="B">B: {{listPart[5]?.questions[part6Index + counterIndex]?.answerB}}</label>
                          <label nz-radio
                                 nzValue="C">C: {{listPart[5]?.questions[part6Index + counterIndex]?.answerC}}</label>
                          <label nz-radio
                                 nzValue="D">D: {{listPart[5]?.questions[part6Index + counterIndex]?.answerD}}</label>
                        </nz-radio-group>
                      </div>
                    </ng-container>
                  </div>
                </div>
                <nz-divider></nz-divider>
              </ng-container>
            </div>
          </ng-container>
          <div class="col-12 d-flex justify-content-between">
            <a class="btn btn-link" (click)="previousPart()">
              <i class="fa fa-arrow-left"></i>
              Previous Part
            </a>
            <a class="btn btn-link" (click)="nextPart()">
              Next Part
              <i class="fa fa-arrow-right"></i>
            </a>
          </div>
        </div>
      </nz-tab>
      <nz-tab nzTitle="Part 7">
        <div class="row">
          <div class="col-12">
            <p class="text-dark mt-3 fs-6 part-content">
              {{listPart[6]?.partContent}}
            </p>
          </div>
          <ng-container *ngFor="let item of listPart[6]?.questions; let part7Index = index;">
            <ng-container *ngIf="item?.questionNumber < 176">
              <div class="row">
                <ng-container
                  *ngIf="questionPart7HasAnswerCheck(item?.questionNumber, questionPart7Has2Answer);">
                <span class="col-12 mt-2 fs-6">Question {{item?.questionNumber}} - {{Number(item?.questionNumber) + 1}}
                  refer to
                  following conversation: </span>
                  <div class="col-7 fs-6 paragraph" translate="no">
                    <pre>
                      {{item?.paragraph1}}
                    </pre>
                  </div>
                  <div class="col-5 px-2">
                    <div class="row">
                      <ng-container *ngFor="let i of counter(2); let counterIndex = index;">
                        <div class="col-12" translate="no" id="questionContainer_6_{{listPart[6]?.questions[part7Index + counterIndex]?.questionId}}">
                          Câu  {{listPart[6]?.questions[part7Index + counterIndex]?.questionNumber}}
                          : {{listPart[6]?.questions[part7Index + counterIndex]?.questionContent}}
                        </div>
                        <div class="col-12">
                          <nz-radio-group nzName="radiogroup" translate="no"
                                          [(ngModel)]="selectedAnswer[listPart[6]?.questions[part7Index + counterIndex]?.questionId]"
                                          (ngModelChange)="changeStateButton($event, listPart[6]?.questions[part7Index + counterIndex]?.questionId)">
                            <label nz-radio
                                   nzValue="A">A: {{listPart[6]?.questions[part7Index + counterIndex]?.answerA}}</label>
                            <label nz-radio
                                   nzValue="B">B: {{listPart[6]?.questions[part7Index + counterIndex]?.answerB}}</label>
                            <label nz-radio
                                   nzValue="C">C: {{listPart[6]?.questions[part7Index + counterIndex]?.answerC}}</label>
                            <label nz-radio
                                   nzValue="D">D: {{listPart[6]?.questions[part7Index + counterIndex]?.answerD}}</label>
                          </nz-radio-group>
                        </div>
                      </ng-container>
                    </div>
                  </div>
                  <nz-divider></nz-divider>
                </ng-container>


                <ng-container
                  *ngIf="questionPart7HasAnswerCheck(item?.questionNumber, questionPart7Has3Answer);">
                <span class="col-12 mt-2 fs-6">Question {{item?.questionNumber}} - {{Number(item?.questionNumber) + 2}}
                  refer to
                  following conversation: </span>
                  <div class="col-7 fs-6 paragraph" translate="no">
                    <pre>
                      {{item?.paragraph1}}
                    </pre>
                  </div>
                  <div class="col-5 px-2">
                    <div class="row">
                      <ng-container *ngFor="let i of counter(3); let counterIndex = index;">
                        <div class="col-12" translate="no" id="questionContainer_6_{{listPart[6]?.questions[part7Index + counterIndex]?.questionId}}">
                          Câu  {{listPart[6]?.questions[part7Index + counterIndex]?.questionNumber}}
                          : {{listPart[6]?.questions[part7Index + counterIndex]?.questionContent}}
                        </div>
                        <div class="col-12">
                          <nz-radio-group nzName="radiogroup" translate="no"
                                          [(ngModel)]="selectedAnswer[listPart[6]?.questions[part7Index + counterIndex]?.questionId]"
                                          (ngModelChange)="changeStateButton($event, listPart[6]?.questions[part7Index + counterIndex]?.questionId)">
                            <label nz-radio
                                   nzValue="A">A: {{listPart[6]?.questions[part7Index + counterIndex]?.answerA}}</label>
                            <label nz-radio
                                   nzValue="B">B: {{listPart[6]?.questions[part7Index + counterIndex]?.answerB}}</label>
                            <label nz-radio
                                   nzValue="C">C: {{listPart[6]?.questions[part7Index + counterIndex]?.answerC}}</label>
                            <label nz-radio
                                   nzValue="D">D: {{listPart[6]?.questions[part7Index + counterIndex]?.answerD}}</label>
                          </nz-radio-group>
                        </div>
                      </ng-container>
                    </div>
                  </div>
                  <nz-divider></nz-divider>
                </ng-container>


                <ng-container
                  *ngIf="questionPart7HasAnswerCheck(item?.questionNumber, questionPart7Has4Answer);">
                <span class="col-12 mt-2 fs-6">Question {{item?.questionNumber}} - {{Number(item?.questionNumber) + 3}}
                  refer to
                  following conversation: </span>
                  <div class="col-7 fs-6 paragraph" translate="no">
                    <pre>
                      {{item?.paragraph1}}
                    </pre>
                  </div>
                  <div class="col-5 px-2">
                    <div class="row">
                      <ng-container *ngFor="let i of counter(4); let counterIndex = index;">
                        <div class="col-12" translate="no" id="questionContainer_6_{{listPart[6]?.questions[part7Index + counterIndex]?.questionId}}">
                          Câu  {{listPart[6]?.questions[part7Index + counterIndex]?.questionNumber}}
                          : {{listPart[6]?.questions[part7Index + counterIndex]?.questionContent}}
                        </div>
                        <div class="col-12">
                          <nz-radio-group nzName="radiogroup" translate="no"
                                          [(ngModel)]="selectedAnswer[listPart[6]?.questions[part7Index + counterIndex]?.questionId]"
                                          (ngModelChange)="changeStateButton($event, listPart[6]?.questions[part7Index + counterIndex]?.questionId)">
                            <label nz-radio
                                   nzValue="A">A: {{listPart[6]?.questions[part7Index + counterIndex]?.answerA}}</label>
                            <label nz-radio
                                   nzValue="B">B: {{listPart[6]?.questions[part7Index + counterIndex]?.answerB}}</label>
                            <label nz-radio
                                   nzValue="C">C: {{listPart[6]?.questions[part7Index + counterIndex]?.answerC}}</label>
                            <label nz-radio
                                   nzValue="D">D: {{listPart[6]?.questions[part7Index + counterIndex]?.answerD}}</label>
                          </nz-radio-group>
                        </div>
                      </ng-container>
                    </div>
                  </div>
                  <nz-divider></nz-divider>
                </ng-container>
              </div>
            </ng-container>

            <ng-container *ngIf="item?.questionNumber > 175">
              <ng-container
                *ngIf="questionPart7HasAnswerCheck(item?.questionNumber, questionPart7Has2Paragraph);">
                <span class="col-12 mt-2 fs-6">Question {{item?.questionNumber}} - {{Number(item?.questionNumber) + 5}}
                  refer to
                  following conversation: </span>
                <div class="col-7 fs-6 paragraph" translate="no">
                  <pre>
                    {{item?.paragraph1}}
                  </pre>
                  <pre>
                    {{item?.paragraph2}}
                  </pre>
                </div>
                <div class="col-5 px-2">
                  <div class="row">
                    <ng-container *ngFor="let i of counter(5); let counterIndex = index;">
                      <div class="col-12" translate="no" id="questionContainer_6_{{listPart[6]?.questions[part7Index + counterIndex]?.questionId}}">
                        Câu  {{listPart[6]?.questions[part7Index + counterIndex]?.questionNumber}}
                        : {{listPart[6]?.questions[part7Index + counterIndex]?.questionContent}}
                      </div>
                      <div class="col-12">
                        <nz-radio-group nzName="radiogroup" translate="no"
                                        [(ngModel)]="selectedAnswer[listPart[6]?.questions[part7Index + counterIndex]?.questionId]"
                                        (ngModelChange)="changeStateButton($event, listPart[6]?.questions[part7Index + counterIndex]?.questionId)">
                          <label nz-radio
                                 nzValue="A">A: {{listPart[6]?.questions[part7Index + counterIndex]?.answerA}}</label>
                          <label nz-radio
                                 nzValue="B">B: {{listPart[6]?.questions[part7Index + counterIndex]?.answerB}}</label>
                          <label nz-radio
                                 nzValue="C">C: {{listPart[6]?.questions[part7Index + counterIndex]?.answerC}}</label>
                          <label nz-radio
                                 nzValue="D">D: {{listPart[6]?.questions[part7Index + counterIndex]?.answerD}}</label>
                        </nz-radio-group>
                      </div>
                    </ng-container>
                  </div>
                </div>
                <nz-divider></nz-divider>
              </ng-container>
            </ng-container>

          </ng-container>
          <div class="col-12 d-flex justify-content-between">
            <a class="btn btn-link" (click)="previousPart()">
              <i class="fa fa-arrow-left"></i>
              Previous Part
            </a>
          </div>
        </div>
      </nz-tab>
    </nz-tabset>
    <div class="col-sm-2 col-12">
      <div class="row right-button">
        <div class="col-12 d-flex flex-column align-items-start">
          <label class="text-center text-dark">Thời gian làm bài: </label>
          <label class="text-center text-dark">
            <i class="fa fa-clock-o" aria-hidden="true"></i>
            120 phút
          </label>
          <div class="time d-flex" [ngClass]="{'text-danger': totalTimeInSeconds < 300}">
            <p #minutes></p>
            <p>:</p>
            <p #seconds></p>
          </div>
        </div>
        <div class="col-12 d-flex flex-column align-items-center justify-content-center">
          <button nz-button nzType="primary" class="mt-1 bg-primary border-0" style="width: 140px;"
                  [nzShape]="'round'" nzSize="large" nzBlock (click)="finishTest()">Nộp bài
          </button>
        </div>
        <div class="col-12">
          <p class="text-info fw-bold">Chú ý: bạn có thể click vào số thứ tự câu hỏi trong bài để chuyển hướng đến câu
            hỏi muốn làm</p>
        </div>
        <ng-container *ngFor="let partIem of listPart; let partIndex = index">
          <div class="col-12">
            <div class="row">
              <div class="col-12">
                <p class="text-dark fw-bold mt-3" [innerText]="partIem?.partName"></p>
              </div>
            </div>
            <div class="row">
              <div class="col-9 row">
                <ng-container *ngFor="let questionButton of partIem?.questions; let questionIndex = index">
                  <div class="col-3">
                    <button class="mb-1 btn btn-outline-primary btn-circle"
                            (click)="switchToTab(partIndex ,questionButton?.questionId)"
                            [ngClass]="{'btn-fill': buttonStates[questionButton?.questionId]}">
                      {{questionButton?.questionNumber}}
                    </button>
                  </div>
                </ng-container>
              </div>
            </div>
          </div>
        </ng-container>
      </div>
    </div>
  </div>
</div>
