<app-page-header
  [title]="title"
  [currentPage]="currentPage">
</app-page-header>

<div class="col-lg-12 grid-margin stretch-card">
  <div class="card">
    <div class="card-body">
      <div class="row">
        <div class="card-title col-2 d-flex g-2">
          <h4>
            <button class="btn btn-sm btn-primary btn-gradient-primary" (click)="openFormAdd()">Thêm mới</button>
          </h4>
          <h4 class="ms-2">
            <button class="btn btn-sm btn-outline-primary btn-gradient-primary" (click)="getBlog()">Làm mới</button>
          </h4>
        </div>
        <div class="col-6">
          <nz-form-item nz-row class="me-3">
            <nz-form-label nz-col nzSpan="6">Sắp xếp theo ngày</nz-form-label>
            <nz-form-control nz-col nzSpan="6">
              <nz-select name="select-sort" [(ngModel)]="params.sort" (ngModelChange)="onChangeSort($event)">
                <nz-option *ngFor="let sort of listSort" [nzValue]="sort.value" [nzLabel]="sort.label"></nz-option>
              </nz-select>
            </nz-form-control>
          </nz-form-item>
        </div>
      </div>
      <nz-table #borderedTable nzBordered [nzData]="listBlog" [nzShowPagination]="false">
        <thead>
        <tr>
          <th> Tác giả</th>
          <th> Tiêu đề</th>
          <th> Tóm tắt</th>
          <th> Hình ảnh</th>
          <th> Ngày tạo</th>
          <th> Ngày cập nhật</th>
          <th> #</th>
        </tr>
        </thead>
        <tbody>
        <ng-container *ngFor="let data of borderedTable.data">
          <tr>
            <td>{{ data.author }}</td>
            <td nzEllipsis [popover]="data.title">{{ data.title }}</td>
            <td>{{ data.summary }}</td>
            <td><img nz-image [nzSrc]="data.thumbnail" style="height: 100px; width: 100px;" [alt]="data?.thumbnail">
            </td>
            <td>{{ data.createdAt | date : formatDate: timeZone }}</td>
            <td>{{ data.updatedAt | date : formatDate: timeZone }}</td>
            <td>
              <button class="btn btn-success btn-rounded btn-sm me-2 " (click)="update(data)"> Sửa</button>
              <button class="btn btn-primary btn-rounded btn-sm me-2" (click)="openDetail(data)"> Xem</button>
              <button class="btn btn-danger btn-rounded btn-sm mt-2" (click)="deleteBlog(data.blogId)"> Xóa</button>
            </td>
          </tr>
        </ng-container>
        </tbody>
      </nz-table>
      <div class="mt-2 d-flex flex-row-reverse">
        <nz-pagination
          [(nzPageIndex)]="this.params.page"
          [nzTotal]="totalElements"
          [nzShowTotal]="rangeTemplate"
          nzShowSizeChanger
          [(nzPageSize)]="this.params.size"
          (nzPageIndexChange)="changePage($event)"
          (nzPageSizeChange)="changeSize($event)"
        ></nz-pagination>
      </div>
    </div>
  </div>
</div>
<ng-template #rangeTemplate let-range="range" let-total>
  {{ range[0] }}-{{ range[1] }} of {{ total }} items
</ng-template>
